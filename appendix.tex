\appendix{}
\gdef\thesection{Appendix \Alph{section}}

\section{Figures}
\label{sec:figures}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=160mm]{figures/ais-nov-2011.pdf}
  \caption{Raw AIS observations, November 2011. Note the observations located in the Hoggar Mountains in Algeria.}
  \label{fig:ais-obs-nov-2011}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=140mm,angle=-90]{figures/cal-cargo.pdf}
  \caption{AIS observations, Southern California Bight. Nov 2011--Dec 2012. Note the ballast water exchange point lower left.}
  \label{fig:cal-cargo}
\end{figure}


\begin{figure}[htbp]
  \centering
  \includegraphics[width=160mm]{figures/ais-and-ports-cea.pdf}
  \caption{Approximate AIS coverage (green), global ports (red). Cylindrical Equal-Area projection}
  \label{fig:ais-coverage}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=160mm]{images/cia-lanes-small-cropped.png}
  \caption{"World Shipping Lanes" map produced by the Central Intelligence Agency, 1973.}
  \label{fig:cia-shipping-map}
\end{figure}


%\section{Tables}

\begin{table}[htbp]
  \begin{tabular}{lr}
    Attribute & Accuracy \\
    \hline
    Location (fixed from GPS signal) & $\simeq$10 meter accuracy) \\
    Timestamp (on broadcast) & $\simeq$100 ms \textit{radio transmission \& processing latency}\\
    Name \\
    Call Sign \\
    Maritime Mobile Service Identity (MMSI) \\
    Heading \\
    Speed \\
    Destination & \textit{rarely valid}
  \end{tabular}
  \caption{AIS broadcast attributes. Update frequency depends on ship speed, but varies between a minimum of a record every 2 seconds for quickly moving vessels, to once per 3 minutes for moored vessels. Additional attributes are available, but infrequently used.}
  \label{table:ais-broadcast-attributes}
\end{table}

\newpage
\section{Source Code}
\label{sec:source-code}

% include SOME python code here -- our AIS parser, what else?
% steps: download AIS
% parse ais
% insert AIS into DB, formalize
% download & parse ship databases

All code used to generate the project is available at https://github.com/scw/ais-kml-parser. Due to it's length, I've opted to omit it here.

%\texttt{aiskml.py}:
%\inputminted[linenos,
%             numbersep=5pt,
%             frame=lines,
%             framesep=2mm]{r}{../code/kml/aiskml.py}

%\texttt{parsekml.py}:
%\inputminted[linenos,
%             numbersep=5pt,
%             frame=lines,
%             framesep=2mm]{r}{../code/kml/parsekml.py}

\section{Record Linkage}
\label{sec:record-linkage-appendix}

% XXX XXX
The Jaro-Winkler formula 

% good code-based illustration at: http://www.gettingcirrius.com/2011/01/calculating-similarity-part-2-jaccard.html
% XXX MOVE THIS TO AN APPENDIX??

The Jaro distance:
\begin{equation}
  d_j = \left\{
  \begin{array}{l l}
    0 & \text{if }m = 0 \\ 
    \frac{1}{3}\left(\frac{m}{|s_1|} + \frac{m}{|s_2|} + \frac{m-t}{m}\right) & \text{otherwise} \end{array} \right.
\end{equation}

$ d_j $ Jaro Distance
m = number of matching patterns
t = number of transposed characters
|s1| = length of first string
|s2| = length of second string

\begin{equation}
  \left\lfloor\frac{\max(|s_1|,|s_2|)}{2}\right\rfloor-1
\end{equation}
range = max(length(a), length(b)) / 2 - 1


Jaro-Winkler distance:

\begin{equation}
  d_w = d_j + (\ell p (1 - d_j))
\end{equation}

